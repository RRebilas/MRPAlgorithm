<form [formGroup]="form">
  <ng-container *ngIf="dataSource$ | async as dataSource">
    <ng-container *ngIf="dataSource?.length !== 0">
      <mat-table
        [dataSource]="dataSource ?? []"
        class="mat-elevation-z8 mrp-table"
        formArrayName="planowanePrzyjecia"
      >
        <ng-container matColumnDef="mrp-week">
          <mat-header-cell *matHeaderCellDef>Okres</mat-header-cell>
          <mat-cell *matCellDef="let element">{{ element.okres }}</mat-cell>
        </ng-container>

        <ng-container matColumnDef="mrp-grossRequirements">
          <mat-header-cell *matHeaderCellDef
            >Całkowite zapotrzebowanie</mat-header-cell
          >
          <mat-cell *matCellDef="let element">{{
            element.calkowiteZapotrzebowanie
          }}</mat-cell>
        </ng-container>

        <ng-container matColumnDef="mrp-scheduled">
          <mat-header-cell *matHeaderCellDef
            >Planowane przyjęcia</mat-header-cell
          >
          <mat-cell *matCellDef="let element">
            <ng-container [formGroupName]="element.okres - 1">
              <input
                type="number"
                matInput
                [min]="0"
                [value]="element.planowanePrzyjecia"
                formControlName="planowanePrzyjecia"
              />
            </ng-container>
          </mat-cell>
        </ng-container>

        <ng-container matColumnDef="mrp-available">
          <mat-header-cell *matHeaderCellDef
            >Przewidywane na stanie</mat-header-cell
          >
          <mat-cell *matCellDef="let element">{{
            element.przewidywaneNaStanie
          }}</mat-cell>
        </ng-container>

        <ng-container matColumnDef="mrp-nettRequirements">
          <mat-header-cell *matHeaderCellDef
            >Zapotrzebowanie netto</mat-header-cell
          >
          <mat-cell *matCellDef="let element">{{
            element.zapotrzebowanieNetto
          }}</mat-cell>
        </ng-container>

        <ng-container matColumnDef="mrp-plannedOrderReceipts">
          <mat-header-cell *matHeaderCellDef
            >Planowane zamówienia</mat-header-cell
          >
          <mat-cell *matCellDef="let element">{{
            element.planowaneZamowienia
          }}</mat-cell>
        </ng-container>

        <ng-container matColumnDef="mrp-plannedOrderRelease">
          <mat-header-cell *matHeaderCellDef
            >Planowane przyjęcie zamówień</mat-header-cell
          >
          <mat-cell *matCellDef="let element">{{
            element.planowanePrzyjecieZamowien
          }}</mat-cell>
        </ng-container>

        <mat-header-row *matHeaderRowDef="displayedColumns"></mat-header-row>
        <mat-row *matRowDef="let row; columns: displayedColumns"></mat-row>
      </mat-table>

      <div class="inputs-container">
        <mat-form-field>
          <mat-label>Czas realizacji</mat-label>
          <input
            type="number"
            matInput
            [min]="0"
            formControlName="czasRealizacji"
          />
        </mat-form-field>
        <mat-form-field>
          <mat-label>Wielkość partii</mat-label>
          <input
            type="number"
            matInput
            [min]="0"
            formControlName="wielkoscPartii"
          />
        </mat-form-field>
        <mat-form-field>
          <mat-label>Na stanie</mat-label>
          <input type="number" matInput [min]="0" formControlName="naStanie" />
        </mat-form-field>
      </div>
    </ng-container>
  </ng-container>
</form>
